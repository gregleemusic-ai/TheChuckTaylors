
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Chuck Taylors ‚Äî Events</title>
  <meta name="theme-color" content="#ff6b35" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --bg:#0d1117; --card:rgba(255,255,255,.06); --card-b:#2b3547; --text:#e5e7eb; --sub:#a3b0c2;
      --brand:#ff6b35; --brand-2:#ffd23f; --danger:#dc2626; --navy:#1e3a8a;
    }
    body{font-family:Inter,system-ui,sans-serif;background:var(--bg);color:var(--text)}
    .card{background:var(--card);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,.08);border-radius:14px}
    .btn{background:var(--brand);color:#0d1117;font-weight:700;border-radius:10px;padding:.6rem .9rem;cursor:pointer;border:none}
    .btn:hover{background:#ff865e}
    .btn-sec{background:transparent;border:1px solid var(--brand);color:var(--brand);border-radius:10px;padding:.5rem .8rem;cursor:pointer}
    .btn-sec:hover{background:rgba(255,107,53,.1)}
    .btn-dark{background:#0b1220;border:1px solid var(--card-b);color:var(--text);border-radius:10px;padding:.5rem .8rem;cursor:pointer}
    .btn-dark:hover{background:#141b2b}
    input,select,textarea{background:#0b1220;border:1px solid var(--card-b);border-radius:10px;padding:.55rem .7rem;width:100%;color:var(--text)}
    textarea{min-height:70px}
    label{font-size:.8rem;color:#cbd5e1}
    .subtle{color:var(--sub)}
    .pill{display:inline-block;font-size:.72rem;padding:.2rem .5rem;border:1px solid var(--card-b);border-radius:999px}
    .kv{display:grid;grid-template-columns:160px 1fr;gap:.5rem}
    @media (max-width:640px){.kv{grid-template-columns:1fr}}
    .chat-msg{background:rgba(255,255,255,.05);padding:.75rem;border-radius:8px;border-left:3px solid var(--brand);margin-bottom:.5rem}
    .payment-gig{background:rgba(255,255,255,.03);border:1px solid var(--card-b);border-radius:8px;padding:1rem;margin-bottom:.75rem}
    .payment-status{display:inline-block;padding:.2rem .6rem;border-radius:6px;font-size:.75rem;font-weight:600}
    .payment-status.paid{background:#10b981;color:#fff}
    .payment-status.unpaid{background:#ef4444;color:#fff}

    dialog{border:none;padding:0;max-width:95vw;max-height:90vh;overflow:auto}
    dialog::backdrop{background:rgba(0,0,0,.7)}
    .modal{background:#1a1f2e !important;border:1px solid var(--card-b) !important;color:#fff !important}
    .modal .subtle{color:#cbd5e1}

    .dialog-inner{display:flex;flex-direction:column;max-height:85vh}
    .dialog-head{position:sticky;top:0;background:#1a1f2e;z-index:1;padding:1rem 1.25rem;border-bottom:1px solid var(--card-b)}
    .dialog-body{overflow:auto;padding:1rem 1.25rem}
    .dialog-actions{position:sticky;bottom:0;background:#1a1f2e;border-top:1px solid var(--card-b);padding:1rem 1.25rem;display:flex;gap:.5rem;flex-wrap:wrap}
    .dialog-actions .btn,.dialog-actions .btn-sec{flex:1 1 140px}

    .form-grid{display:grid;grid-template-columns:repeat(12,minmax(0,1fr));gap:.75rem}
    .field{grid-column:span 12}
    @media (min-width:768px){.field{grid-column:span 6}}
    .field-full{grid-column:span 12}
    .check{display:flex;align-items:center;gap:.5rem}

    .cal-grid{display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:2px;margin-top:.5rem}
    .cal-header{font-size:.8rem;font-weight:700;color:#cbd5e1;text-align:center;padding:.5rem;background:#1a1f2e}
    .cal-day{min-height:86px;background:#fff;color:#0d1117;padding:.5rem;border-radius:4px;position:relative;cursor:pointer;transition:all .2s}
    .cal-day:hover{transform:scale(1.02);box-shadow:0 4px 12px rgba(255,107,53,.3)}
    .cal-day.has-event{background:var(--brand);color:#fff;font-weight:700}
    .cal-day.hold{background:var(--navy) !important;color:#fff !important;font-weight:700}
    .cal-day.band-off{background:var(--danger) !important;color:#fff !important;font-weight:700}
    .cal-day .cal-event{font-size:.72rem;background:rgba(0,0,0,.18);padding:.18rem .3rem;margin-top:.2rem;border-radius:3px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .cal-day.other-month{opacity:.35}
    .cal-day-num{font-size:1.05rem;font-weight:800;margin-bottom:.25rem}
    .cal-day.today{outline:3px solid var(--brand-2);outline-offset:1px}
    .cal-nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem}

    .repo-actions{display:flex;gap:.5rem;flex-wrap:wrap}
    @media (max-width:640px){
      .repo-actions .btn-dark{flex:1 1 calc(33.33% - .5rem);min-width:110px;text-align:center}
    }

    .stack-sm{display:grid;gap:.75rem}
    @media (min-width:1280px){.xl-grid-3{display:grid;grid-template-columns:2fr 1fr;gap:1.25rem}}
    
    #loginScreen{
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
      background:var(--bg);
    }
    
    #appContent{display:none}
    
    .login-card{
      max-width:420px;
      width:100%;
      margin:0 1rem;
    }
    
    .setup-banner {
      background: #ffd23f;
      color: #0d1117;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <!-- Setup Instructions Banner (remove after Firebase is configured) -->
  <div id="setupBanner" class="setup-banner" style="max-width:900px;margin:1rem auto;">
    ‚ö†Ô∏è <strong>Setup Required:</strong> Replace Firebase config in the code and create user accounts. See instructions at bottom of file.
  </div>

  <!-- Login Screen -->
  <div id="loginScreen">
    <div class="login-card card p-8">
      <h1 class="text-3xl font-extrabold mb-2 text-center">The Chuck Taylors</h1>
      <p class="text-center subtle mb-6">Band Management System</p>
      
      <div id="loginForm">
        <div class="mb-4">
          <label class="block mb-2">Email</label>
          <input id="loginEmail" type="email" placeholder="your@email.com" />
        </div>
        <div class="mb-4">
          <label class="block mb-2">Password</label>
          <input id="loginPassword" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
        </div>
        <div id="loginError" class="text-red-500 text-sm mb-4 hidden"></div>
        <button id="loginBtn" class="btn w-full">Sign In</button>
      </div>
      
      <div class="mt-6 text-xs subtle text-center">
        Secure access for band members only
      </div>
    </div>
  </div>

  <!-- Main App (hidden until logged in) -->
  <div id="appContent">
    <div class="max-w-6xl mx-auto p-4 md:p-8">
      <header class="flex items-center justify-between mb-6 gap-3 flex-wrap">
        <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight">The Chuck Taylors ‚Äî Events</h1>
        <div class="flex items-center gap-2 flex-wrap text-sm text-slate-300">
          <button id="setProfileBtn" class="btn-sec">üôã My Profile</button>
          <button id="logoutBtn" class="btn-sec">‚Ü©Ô∏é Sign Out</button>
          <span id="profileStatus" class="text-xs subtle"></span>
          <span id="adminStatus" class="text-xs subtle"></span>
        </div>
      </header>

      <!-- Control bar -->
      <div class="card p-3 md:p-4 mb-6">
        <div class="flex items-center justify-between gap-2 flex-wrap">
          <div class="text-sm text-slate-300">Events ‚Ä¢ Chat ‚Ä¢ Payments ‚Ä¢ Charts ‚Ä¢ YouTube</div>
          <div class="flex items-center gap-2 flex-wrap">
            <button id="showeventsBtn" class="btn-sec">üìÖ Dates</button>
            <button id="toggleChatBtn" class="btn-sec">üí¨ Chat</button>
            <button id="togglePaymentsBtn" class="btn-sec">üí∞ Payments</button>
            <button id="toggleChartsBtn" class="btn-sec">üìä Charts</button>
            <button id="toggleYouTubeBtn" class="btn-sec">üé¨ YouTube</button>
            <button id="addGigBtn" class="btn hidden">+ New Event</button>
          </div>
        </div>
      </div>

      <!-- Events View -->
      <div id="eventsView">
        <div class="xl-grid-3">
          <div class="card p-4 min-w-0">
            <div class="cal-nav">
              <button id="prevMonth" class="btn-sec">‚Üê Prev</button>
              <h2 id="calTitle" class="text-2xl font-bold"></h2>
              <button id="nextMonth" class="btn-sec">Next ‚Üí</button>
            </div>
            <div class="flex gap-4 mb-3 text-sm flex-wrap">
              <div class="flex items-center gap-2"><div class="w-4 h-4 bg-white rounded"></div><span>Open Date</span></div>
              <div class="flex items-center gap-2"><div class="w-4 h-4 bg-orange-500 rounded"></div><span>Gig Scheduled</span></div>
              <div class="flex items-center gap-2"><div class="w-4 h-4 bg-red-600 rounded"></div><span>Band Off</span></div>
              <div class="flex items-center gap-2"><div class="w-4 h-4 bg-blue-900 rounded"></div><span>Hold</span></div>
              <div class="flex items-center gap-2"><div class="w-4 h-4 border-4 border-yellow-400 rounded"></div><span>Today</span></div>
            </div>
            <div id="monthlyCalendar"></div>
          </div>

          <div class="card p-4 min-w-0 mt-6 xl:mt-0">
            <div class="flex items-center justify-between">
              <h2 class="text-xl font-bold mb-4">Upcoming Events</h2>
            </div>
            <div id="eventsList" class="space-y-3"></div>
          </div>
        </div>
      </div>

      <!-- Chat -->
      <div id="chatView" class="hidden">
        <div class="card p-6 stack-sm">
          <div class="flex items-center justify-between flex-wrap gap-2">
            <h2 class="text-2xl font-bold">Band Chat</h2>
            <div class="flex gap-2">
              <button id="clearChatBtn" class="btn-sec hidden">üóëÔ∏è Clear Chat (Admin)</button>
            </div>
          </div>
          <div id="chatMessages" class="bg-black bg-opacity-30 rounded-lg p-4 h-96 overflow-y-auto"></div>
          <div class="flex gap-2">
            <input id="chatInput" type="text" placeholder="Type a message..." class="flex-1" />
            <button id="sendChat" class="btn">Send</button>
          </div>
          <p class="text-xs subtle">Messages sync in real-time across all devices.</p>
        </div>
      </div>

      <!-- Payments -->
      <div id="paymentsView" class="hidden">
        <div class="card p-6">
          <h2 class="text-2xl font-bold mb-4">Payments ‚Äî YTD 2025</h2>
          <div id="ytdSummary" class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"></div>
          <div id="paymentsList"></div>
        </div>
      </div>

      <!-- Charts / PDFs -->
      <div id="chartsView" class="hidden">
        <div class="card p-6">
          <div class="flex items-center justify-between flex-wrap gap-3">
            <h2 class="text-2xl font-bold">Charts & PDFs</h2>
            <span class="pill">Shared repository</span>
          </div>

          <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3">
            <div class="card p-4">
              <h3 class="text-xl font-semibold mb-2">Upload PDFs</h3>
              <p class="text-sm subtle mb-3">Stage plots, setlists, riders, song charts‚Ä¶ (PDF only)</p>
              <input id="pdfInput" type="file" accept="application/pdf" multiple />
              <div class="mt-3"><input id="pdfTitle" type="text" placeholder="Optional: title/notes" /></div>
              <div class="mt-3"><button id="uploadPdfBtn" class="btn">Upload</button></div>
            </div>

            <div class="card p-4">
              <h3 class="text-xl font-semibold mb-2">Find Files</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <input id="searchPdf" type="text" placeholder="Search by filename or notes..." />
                <select id="uploaderFilter"><option value="">All uploaders</option></select>
              </div>
              <div class="mt-3 flex gap-2 flex-wrap">
                <button id="clearFiltersBtn" class="btn-sec">Clear filters</button>
              </div>
            </div>
          </div>

          <div class="mt-6">
            <h3 class="text-xl font-bold mb-3">Repository</h3>
            <div id="pdfList" class="grid sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
            <div id="emptyRepo" class="text-slate-400 text-sm hidden">No files yet. Be the first to upload!</div>
          </div>
        </div>
      </div>

      <!-- YouTube -->
      <div id="youtubeView" class="hidden">
        <div class="card p-6">
          <div class="flex items-center justify-between flex-wrap gap-3">
            <h2 class="text-2xl font-bold">YouTube Links</h2>
            <span class="pill">Shared repository</span>
          </div>

          <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3">
            <div class="card p-4">
              <h3 class="text-xl font-semibold mb-2">Add a YouTube Link</h3>
              <p class="text-sm subtle mb-3">Paste a YouTube URL or 11-character video ID.</p>
              <input id="ytUrl" type="text" placeholder="https://www.youtube.com/watch?v=VIDEOID or VIDEOID" />
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2 mt-3">
                <input id="ytTitle" type="text" placeholder="Optional title" />
                <input id="ytNotes" type="text" placeholder="Optional notes" />
              </div>
              <div class="mt-3">
                <button id="addYtBtn" class="btn">Add Link</button>
              </div>
            </div>

            <div class="card p-4">
              <h3 class="text-xl font-semibold mb-2">Find Links</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <input id="ytSearch" type="text" placeholder="Search by title or notes..." />
                <select id="ytUploaderFilter"><option value="">All uploaders</option></select>
              </div>
              <div class="mt-3 flex gap-2 flex-wrap">
                <button id="ytClearFilters" class="btn-sec">Clear filters</button>
              </div>
            </div>
          </div>

          <div class="mt-6">
            <h3 class="text-xl font-bold mb-3">Repository</h3>
            <div id="ytList" class="grid sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
            <div id="ytEmpty" class="text-slate-400 text-sm hidden">No links yet. Add your first!</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals (Event Detail, New Event, PDF Preview, YouTube Player, Profile) -->
  <!-- [Modal HTML omitted for brevity - same structure as before] -->

  <!-- Firebase SDK & Application Logic -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import { getDatabase, ref, set, get, push, onValue, remove, update } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

    // ============================================
    // FIREBASE CONFIG - REPLACE WITH YOUR VALUES
    // ============================================
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY_HERE",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Admin emails - ADD YOUR ADMIN EMAIL(S) HERE
    const ADMIN_EMAILS = ['admin@example.com'];

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    window.currentUser = null;
    window.currentUserProfile = null;
    window.isAdmin = false;

    const BAND_MEMBERS = ['greg','john','tim','brian','mark'];
    const MEMBER_NAMES = { greg:'Greg', john:'John', tim:'Tim', brian:'Brian', mark:'Mark' };

    // Authentication UI
    const loginScreen = document.getElementById('loginScreen');
    const appContent = document.getElementById('appContent');
    const loginEmail = document.getElementById('loginEmail');
    const loginPassword = document.getElementById('loginPassword');
    const loginBtn = document.getElementById('loginBtn');
    const loginError = document.getElementById('loginError');
    const logoutBtn = document.getElementById('logoutBtn');

    loginBtn.onclick = async () => {
      const email = loginEmail.value.trim();
      const password = loginPassword.value;
      
      if (!email || !password) {
        showLoginError('Please enter email and password');
        return;
      }

      try {
        loginBtn.disabled = true;
        loginBtn.textContent = 'Signing in...';
        await signInWithEmailAndPassword(auth, email, password);
        loginError.classList.add('hidden');
      } catch (error) {
        console.error('Login error:', error);
        showLoginError(getErrorMessage(error.code));
        loginBtn.disabled = false;
        loginBtn.textContent = 'Sign In';
      }
    };

    loginPassword.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') loginBtn.click();
    });

    logoutBtn.onclick = async () => {
      if (confirm('Sign out?')) {
        await signOut(auth);
      }
    };

    function showLoginError(msg) {
      loginError.textContent = msg;
      loginError.classList.remove('hidden');
    }

    function getErrorMessage(code) {
      switch(code) {
        case 'auth/invalid-email': return 'Invalid email address';
        case 'auth/user-disabled': return 'This account has been disabled';
        case 'auth/user-not-found': return 'No account found with this email';
        case 'auth/wrong-password': return 'Incorrect password';
        case 'auth/invalid-credential': return 'Invalid email or password';
        default: return 'Login failed. Please try again.';
      }
    }

    onAuthStateChanged(auth, async (user) => {
      if (user) {
        window.currentUser = user;
        window.isAdmin = ADMIN_EMAILS.includes(user.email.toLowerCase());
        
        const profileSnapshot = await get(ref(db, `users/${user.uid}/profile`));
        window.currentUserProfile = profileSnapshot.val() || '';
        
        loginScreen.style.display = 'none';
        appContent.style.display = 'block';
        
        updateProfileStatus();
        updateAdminStatus();
        init();
      } else {
        window.currentUser = null;
        window.currentUserProfile = null;
        window.isAdmin = false;
        loginScreen.style.display = 'flex';
        appContent.style.display = 'none';
        loginBtn.disabled = false;
        loginBtn.textContent = 'Sign In';
        loginPassword.value = '';
      }
    });

    function updateProfileStatus() {
      const el = document.getElementById('profileStatus');
      if (window.currentUserProfile) {
        el.textContent = `‚Ä¢ ${MEMBER_NAMES[window.currentUserProfile]}`;
      } else {
        el.textContent = '‚Ä¢ Set your profile';
      }
    }

    function updateAdminStatus() {
      const el = document.getElementById('adminStatus');
      el.textContent = window.isAdmin ? '‚Ä¢ Admin' : '';
      
      document.getElementById('addGigBtn').classList.toggle('hidden', !window.isAdmin);
      document.getElementById('clearChatBtn').classList.toggle('hidden', !window.isAdmin);
    }

    // Initialize app
    function init() {
      setupEventsListener();
      renderCalendar();
    }

    let eventsCache = [];
    let calendarDate = new Date();

    function setupEventsListener() {
      const eventsRef = ref(db, 'events');
      onValue(eventsRef, (snapshot) => {
        const data = snapshot.val();
        eventsCache = data ? Object.entries(data).map(([id, val]) => ({id, ...val})) : [];
        renderCalendar();
        renderEvents();
      });
    }

    function renderCalendar() {
      // Calendar rendering logic (same as before)
      console.log('Calendar rendered');
    }

    function renderEvents() {
      const eventsList = document.getElementById('eventsList');
      eventsList.innerHTML = eventsCache.length === 0 
        ? '<div class="text-slate-400 text-sm">No events yet. Add your first event!</div>'
        : '';
      // Event list rendering logic
    }

    document.getElementById('showeventsBtn').onclick = () => {
      document.getElementById('eventsView').classList.remove('hidden');
      document.getElementById('chatView').classList.add('hidden');
      document.getElementById('paymentsView').classList.add('hidden');
      document.getElementById('chartsView').classList.add('hidden');
      document.getElementById('youtubeView').classList.add('hidden');
    };

    console.log('Firebase app initialized');
  </script>
</body>
</html>

